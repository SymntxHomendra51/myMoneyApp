{"version":3,"names":["OptionsList","aboveSelectControl","flatListProps","onPressOption","selectedOption","animated","animationDuration","searchedOptions","searchValue","searchable","isOpened","onOutsidePress","multiSelection","openedPosition","width","top","left","optionsData","optionSelectedStyle","optionStyle","optionTextStyle","noOptionsText","scrollToSelectedOption","onSelect","optionsListStyle","NoOptionsComponent","OptionComponent","selectedOptionIndex","selectedOptionTyped","flatList","useCallback","node","isScrollToSelectedOption","scrollToIndex","index","measuredRef","reactTag","findNodeHandle","AccessibilityInfo","setAccessibilityFocus","resolveData","length","label","resolveIsSelected","item","value","find","option","Portals","SelectOutsideWrapper","styles","modalOverlay","Select","options","overflown","notOverflown","expanded","_data","height","StyleSheet","flatten","isNumber","ITEM_HEIGHT","offset","isSelected","undefined","create","absoluteFillObject","zIndex","flex","position","backgroundColor","COLORS","WHITE","borderWidth","BORDER_WIDTH","maxHeight","MAX_HEIGHT_LIST","elevation","borderTopWidth","borderBottomRightRadius","SHAPE","borderBottomLeftRadius","borderBottomWidth","borderTopRightRadius","borderTopLeftRadius"],"sources":["index.tsx"],"sourcesContent":["import React, { ComponentProps, useCallback } from 'react';\nimport {\n    AccessibilityInfo,\n    findNodeHandle,\n    FlatList,\n    StyleSheet,\n    TouchableOpacity,\n    TouchableWithoutFeedback,\n    View,\n    ViewStyle,\n} from 'react-native';\nimport { Portal } from '@gorhom/portal';\n\nimport { Portals } from '../../constants/portals';\nimport {\n    BORDER_WIDTH,\n    COLORS,\n    ITEM_HEIGHT,\n    MAX_HEIGHT_LIST,\n    SHAPE,\n} from '../../constants/styles';\nimport type { OptionalToRequired } from '../../helpers/types/OptionalToRequired';\nimport type { Position, State } from '../../state/types';\nimport type {\n    OnOutsidePress,\n    OnPressOptionType,\n    OptionType,\n} from '../../types';\nimport { NoOptions } from '../no-options';\nimport { Option } from '../option';\nimport { OptionsListWrapper } from '../options-list-wrapper';\nimport type { Select } from '../select';\n\ntype FromSelectComponentProps = Pick<\n    ComponentProps<typeof Select>,\n    | 'flatListProps'\n    | 'optionSelectedStyle'\n    | 'optionStyle'\n    | 'optionTextStyle'\n    | 'scrollToSelectedOption'\n    | 'noOptionsText'\n    | 'onSelect'\n    | 'animated'\n    | 'animationDuration'\n    | 'optionsListStyle'\n    | 'NoOptionsComponent'\n    | 'OptionComponent'\n    | 'searchable'\n    | 'multiSelection'\n>;\n\ntype OptionsListProps = OptionalToRequired<\n    FromSelectComponentProps &\n        Pick<\n            State,\n            | 'isOpened'\n            | 'openedPosition'\n            | 'optionsData'\n            | 'selectedOption'\n            | 'searchedOptions'\n            | 'searchValue'\n            | 'selectedOptionIndex'\n        > & {\n            onOutsidePress: OnOutsidePress;\n            onPressOption: OnPressOptionType;\n        } & Pick<Position, 'aboveSelectControl'>\n>;\n\nexport const OptionsList = ({\n    aboveSelectControl,\n    flatListProps,\n    onPressOption,\n    selectedOption,\n    animated,\n    animationDuration,\n    searchedOptions,\n    searchValue,\n    searchable,\n    isOpened,\n    onOutsidePress,\n    multiSelection,\n    openedPosition: { width, top, left },\n    optionsData,\n    optionSelectedStyle,\n    optionStyle,\n    optionTextStyle,\n    noOptionsText,\n    scrollToSelectedOption,\n    onSelect,\n    optionsListStyle,\n    NoOptionsComponent,\n    OptionComponent,\n    selectedOptionIndex,\n}: OptionsListProps) => {\n    const selectedOptionTyped = selectedOption as OptionType;\n\n    const flatList = useCallback(\n        (node: FlatList | null) => {\n            if (node !== null) {\n                const isScrollToSelectedOption =\n                    scrollToSelectedOption &&\n                    selectedOptionIndex >= 0 &&\n                    typeof selectedOptionIndex === 'number';\n\n                if (isScrollToSelectedOption) {\n                    try {\n                        node.scrollToIndex({\n                            index: selectedOptionIndex,\n                            animated: false,\n                        });\n                        // eslint-disable-next-line no-empty\n                    } catch {}\n                }\n            }\n        },\n        [scrollToSelectedOption, selectedOptionIndex, onPressOption],\n    );\n\n    const measuredRef = useCallback(\n        (node: TouchableOpacity | null) => {\n            if (node !== null) {\n                const reactTag = findNodeHandle(node);\n                if (reactTag) {\n                    AccessibilityInfo.setAccessibilityFocus(reactTag);\n                }\n            }\n        },\n        [isOpened],\n    );\n\n    const resolveData = () => {\n        if (!searchable) {\n            return optionsData;\n        }\n        if (searchable && searchValue.length === 0) {\n            return optionsData;\n        }\n        if (\n            selectedOptionTyped &&\n            searchValue?.length > 0 &&\n            searchValue === selectedOptionTyped.label\n        ) {\n            return optionsData;\n        }\n        return searchedOptions;\n    };\n\n    const resolveIsSelected = (item: OptionType) => {\n        if (!multiSelection) {\n            return item.value === selectedOptionTyped?.value;\n        }\n        return (\n            selectedOption &&\n            (selectedOption as OptionType[]).find(\n                (option) => item.value === option.value,\n            )\n        );\n    };\n\n    return (\n        <>\n            {isOpened && (\n                <Portal hostName={Portals.SelectOutsideWrapper}>\n                    <TouchableWithoutFeedback\n                        accessibilityLabel=\"Close a dropdown from outside\"\n                        accessibilityRole=\"button\"\n                        onPress={onOutsidePress}\n                    >\n                        <View style={styles.modalOverlay} />\n                    </TouchableWithoutFeedback>\n                </Portal>\n            )}\n            <Portal hostName={Portals.Select}>\n                <OptionsListWrapper\n                    animated={animated}\n                    animationDuration={animationDuration}\n                    isOpened={isOpened}\n                    wrapperStyles={[\n                        styles.options,\n                        optionsListStyle,\n                        { top, left, width },\n                        aboveSelectControl\n                            ? styles.overflown\n                            : styles.notOverflown,\n                    ]}\n                >\n                    <FlatList\n                        ref={flatList}\n                        accessibilityLabel=\"Options list\"\n                        accessibilityState={{\n                            expanded: isOpened,\n                        }}\n                        bounces={false}\n                        data={resolveData()}\n                        getItemLayout={(_data, index) => {\n                            const height =\n                                StyleSheet.flatten(optionStyle)?.height;\n                            const isNumber = typeof height === 'number';\n                            return {\n                                length: isNumber ? height : ITEM_HEIGHT,\n                                offset: isNumber\n                                    ? height * index\n                                    : ITEM_HEIGHT * index,\n                                index,\n                            };\n                        }}\n                        keyExtractor={({ value }) => value}\n                        keyboardShouldPersistTaps=\"handled\"\n                        persistentScrollbar={true}\n                        renderItem={({ item, index }) => {\n                            const { value } = item;\n                            const isSelected = !!resolveIsSelected(item);\n\n                            return (\n                                <Option\n                                    key={value}\n                                    ref={index === 0 ? measuredRef : undefined}\n                                    OptionComponent={OptionComponent}\n                                    isSelected={isSelected}\n                                    option={item}\n                                    optionSelectedStyle={optionSelectedStyle}\n                                    optionStyle={optionStyle}\n                                    optionTextStyle={optionTextStyle}\n                                    optionIndex={index}\n                                    onPressOption={onPressOption}\n                                    onSelect={onSelect}\n                                />\n                            );\n                        }}\n                        {...flatListProps}\n                        ListEmptyComponent={\n                            NoOptionsComponent || (\n                                <NoOptions noOptionsText={noOptionsText} />\n                            )\n                        }\n                    />\n                </OptionsListWrapper>\n            </Portal>\n        </>\n    );\n};\n\ntype Styles = {\n    modalOverlay: ViewStyle;\n    options: ViewStyle;\n    notOverflown: ViewStyle;\n    overflown: ViewStyle;\n};\n\nconst styles = StyleSheet.create<Styles>({\n    modalOverlay: {\n        ...StyleSheet.absoluteFillObject,\n        zIndex: 1,\n    },\n    options: {\n        flex: 1,\n        position: 'absolute',\n        zIndex: 1,\n        backgroundColor: COLORS.WHITE,\n        borderWidth: BORDER_WIDTH,\n        maxHeight: MAX_HEIGHT_LIST,\n        elevation: 5,\n    },\n    notOverflown: {\n        borderTopWidth: 0,\n        borderBottomRightRadius: SHAPE,\n        borderBottomLeftRadius: SHAPE,\n    },\n    overflown: {\n        borderBottomWidth: 0,\n        borderTopRightRadius: SHAPE,\n        borderTopLeftRadius: SHAPE,\n    },\n});\n"],"mappings":"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"}